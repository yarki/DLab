sparkR.session()

full_path <- function(file_path) {
  working_bucket <- "jan23mon-dmytro-liaskovskyi-bucket"
  sprintf("s3a://%s/%s", working_bucket, file_path)
}
--------------------------------------
carriers <- read.df(full_path("carriers.csv"), "csv", header="true", inferSchema="true")
write.df(carriers, path=full_path("R_processed_emr/carriers"), source="parquet", mode="overwrite")
createOrReplaceTempView(carriers, "carriers")
--------------------------------------
airports <- read.df(full_path("airports.csv"), "csv", header="true", inferSchema="true")
write.df(airports, path=full_path("R_processed_emr/airports"), source="parquet", mode="overwrite")
createOrReplaceTempView(airports, "airports")
------------------------------------
flights_w_na <- read.df(full_path("2008.csv.bz2"), "csv", header="true", inferSchema="true")
flights <- fillna(flights_w_na, 0, cols=colnames(flights_w_na)[c(15, 16, 25:29)])
write.df(flights, path=full_path("R_processed_emr/flights"), source="parquet", mode="overwrite")
createOrReplaceTempView(flights, "flights")
colnames(flights)
head(flights_w_na, 5)[c("ArrDelay","CarrierDelay","WeatherDelay","Distance")]
head(flights, 5)[c("ArrDelay","CarrierDelay","WeatherDelay","Distance")]
-------------------------------------