{"paragraphs":[{"text":"%spark\r\nimport org.apache.spark.sql._\r\n\r\nval workingBucket = \"s3a://rglova929test2-dmytro-liaskovskyi-bucket\"\r\nval sqlCtx = new SQLContext(sc)\r\nval hc = sc.hadoopConfiguration\r\nhc.set(\"hive.execution.engine\", \"mr\")\r\n","dateUpdated":"2017-01-24T21:43:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485292939659_-2023540771","id":"20170120-150939_1549034406","dateCreated":"2017-01-24T21:22:19+0000","dateStarted":"2017-01-24T21:32:27+0000","dateFinished":"2017-01-24T21:32:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9905","errorMessage":"","title":"Initialize. Connect to S3 bucket","focus":true},{"text":"%spark\ndef fullPath(path: String) = {\n    s\"$workingBucket/$path\"\n}\n\nval carriers = sqlCtx.read.\n                        format(\"com.databricks.spark.csv\").\n                        //option(\"inferSchema\", \"true\").\n                        option(\"header\", \"true\").\n                        load(fullPath(\"carriers.csv\"))\ncarriers.write.mode(SaveMode.Overwrite).parquet(fullPath(\"scala_processed_local/carriers/\"))\ncarriers.createOrReplaceTempView(\"carriers\")\ncarriers.show(20)","dateUpdated":"2017-01-24T21:44:16+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485292939659_-2023540771","id":"20170120-151133_1703773120","dateCreated":"2017-01-24T21:22:19+0000","dateStarted":"2017-01-24T21:32:43+0000","dateFinished":"2017-01-24T21:34:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:9906","errorMessage":"","title":"process CARRIERS data","focus":true},{"text":"%spark\nval airports = sqlCtx.read.\n                        format(\"com.databricks.spark.csv\").\n                        //option(\"inferSchema\", \"true\").\n                        option(\"header\", \"true\").\n                        load(fullPath(\"airports.csv\"))\nairports.write.mode(SaveMode.Overwrite).parquet(fullPath(\"scala_processed_local/airports/\"))\nairports.createOrReplaceTempView(\"airports\")\nairports.show(20)","dateUpdated":"2017-01-24T21:45:45+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485293374677_-392005696","id":"20170124-212934_103706299","dateCreated":"2017-01-24T21:29:34+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:9907","errorMessage":"","title":"process AIRPORTS data","focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485294313784_-769900804","id":"20170124-214513_801806968","dateCreated":"2017-01-24T21:45:13+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10146","text":"%spark\nimport sqlCtx.implicits._\n\nval flights_w_na = sqlCtx.read.\n                        format(\"com.databricks.spark.csv\").\n                        //option(\"inferSchema\", \"true\").\n                        option(\"header\", \"true\").\n                        option(\"nullValue\", \"NA\").\n                        load(fullPath(\"2008.csv.bz2\"))\nval flights = flights_w_na.na.fill(0)\nflights.write.mode(SaveMode.Overwrite).parquet(fullPath(\"scala_processed_local/flights/\"))\nflights.createOrReplaceTempView(\"flights\")\nflights.select($\"ArrDelay\",$\"CarrierDelay\",$\"WeatherDelay\",$\"Distance\").show(20)","dateUpdated":"2017-01-24T21:46:29+0000","title":"process FLIGHTS data (~100Mb)"}],"name":"Scala","id":"2C7JXVXY7","angularObjects":{"2C3B8E6M6:shared_process":[],"2C6RJRBD1:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}